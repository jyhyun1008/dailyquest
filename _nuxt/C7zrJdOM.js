import{_ as x}from"./Csc9ainO.js";import{r as o,g as N,j as b,c as u,a as e,d as g,b as I,w as V,t as c,k as O,v as B,l as y,m as L,F as R,n as j,o as d}from"./CFgs2USP.js";const C={id:"parent-wrapper"},z={id:"point-wrapper"},P={class:"quest-done"},A={style:{"font-size":"4rem"}},J={id:"quest-wrapper"},E={id:"quest-items-wrapper"},D={class:"quest-items"},F={key:0,class:"quest-category"},M={key:1,class:"quest-item"},U={class:"quest-title"},Q={class:"quest-point"},W={__name:"update",setup(G){const q=o(null),n=o(null),p=o(null),$=o(null),v=o(null),S=o(!0),w=o(null),m=N();var i="";const l=o(null),T=function(){return"/record/"},f=function(a){return{title:a.split("- ")[1]?.split(":")[0],point:parseInt(a.split(": ")[1]?.split("í¬ì¸íŠ¸")[0])}},k=async function(a){await $fetch(`https://${localStorage.getItem("host")}/api/notes/create`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${l.value}`,"Content-Type":"application/json"},body:JSON.stringify({text:`${n.value}ì˜ #dailyquest ì˜ˆìš”!
#${n.value}_dq_list
\`\`\`
${a}
\`\`\``,visibility:"specified"})}),location.href="https://quest.howeverina.studio/"};return b(async()=>{if(l.value=localStorage.getItem("accessToken")?localStorage.getItem("accessToken"):m.query.at?m.query.at:"",!l){w.value=new Error("URLì— accessTokenì´ ì—†ìŠµë‹ˆë‹¤."),S.value=!1;return}const a=await $fetch(`https://${localStorage.getItem("host")}/api/i`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${l.value}`,"Content-Type":"application/json"},body:JSON.stringify({})});n.value=a.username,q.value=a;const s=(await $fetch(`https://${localStorage.getItem("host")}/api/notes/search-by-tag`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${l.value}`,"Content-Type":"application/json"},body:JSON.stringify({tag:`${n.value}_dq_list`})}))[0]?.text.split("```\n")[1]?.split("\n```")[0]?.split(`
`);p.value=s,i=s.join(`
`),document.querySelector("#quest-list").addEventListener("input",h=>{console.log("dd"),p.value=h.target.value.split(`
`)});let r=await $fetch(`https://${localStorage.getItem("host")}/api/notes/search-by-tag`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${l.value}`,"Content-Type":"application/json"},body:JSON.stringify({tag:`${n.value}_dailyquest`})});r=r.filter(h=>h.user.username==n.value),$.value=r,v.value=0,r.length!==0&&(v.value=parseInt(r[0].text.split("í¬ì¸íŠ¸: ðŸª™ ")[1].split(`
`)[0]))}),(a,t)=>{const _=x;return d(),u("div",C,[e("div",z,[e("div",null,[t[3]||(t[3]=g("ë‚´ê°€ ê°€ì§„ í¬ì¸íŠ¸ ",-1)),e("span",P,[I(_,{to:T()},{default:V(()=>[...t[2]||(t[2]=[g("ë‚´ì—­",-1)])]),_:1},8,["to"])])]),e("div",A,"ðŸª™ "+c(v.value),1)]),e("div",J,[t[5]||(t[5]=e("h2",null,"ðŸŒ¸ ë‚´ í€˜ìŠ¤íŠ¸ ðŸŒ¸",-1)),O(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=s=>L(i)?i.value=s:i=s),id:"quest-list"},null,512),[[B,y(i)]]),e("span",{class:"quest-button",onClick:t[1]||(t[1]=s=>k(y(i)))},"ìˆ˜ì •ì™„ë£Œ"),t[6]||(t[6]=e("h2",null,"ðŸŒ¸ ë¯¸ë¦¬ë³´ê¸° ðŸŒ¸",-1)),e("div",E,[(d(!0),u(R,null,j(p.value,s=>(d(),u("div",D,[s[0]!=="-"?(d(),u("div",F,[e("h3",null,c(s),1)])):(d(),u("div",M,[e("div",U,c(f(s).title),1),e("div",Q,c(f(s).point),1),t[4]||(t[4]=e("div",{class:"quest-done"},"ì™„ë£Œ",-1))]))]))),256))])])])}}};export{W as default};
