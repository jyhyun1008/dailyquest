import{_ as k}from"./CTzCITxK.js";import{q as $,r as i,j as x,c as A,a as r,b as C,w as U,k as I,v as S,l as m,m as V,F as b,o as q,d as R}from"./CegRrspc.js";let g;g=globalThis.crypto;async function N(n){return(await g).getRandomValues(new Uint8Array(n))}async function T(n){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~";let o="";const a=await N(n);for(let l=0;l<n;l++){const s=a[l]%t.length;o+=t[s]}return o}async function B(n){return await T(n)}async function D(n){const t=await(await g).subtle.digest("SHA-256",new TextEncoder().encode(n));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function z(n){const t=await B(n),o=await D(t);return{code_verifier:t,code_challenge:o}}const E={class:"h-app"},F={id:"parent-wrapper"},M={id:"quest-wrapper"},L={__name:"login",async setup(n){let t,o;var a="";const l=([t,o]=$(()=>z(128)),t=await t,o(),t),s=i(null),h=i(null),c=i(null),d=i(null),u=i(null),p=l.code_challenge,f=l.code_verifier;async function w(_){const e=await $fetch(`https://${_}/.well-known/oauth-authorization-server`);console.log(e),s.value=e.authorization_endpoint,h.value=e.token_endpoint,localStorage.setItem("token_endpoint",h.value),localStorage.setItem("host",_),localStorage.setItem("code_verifier",f),console.log(`${s.value}?client_id=${u.value}&response_type=code&redirect_uri=${d.value}&scope=read%3Aaccount%20write%3Anotes%20read%3Areactions&code_challenge=${p}&code_challenge_method=S256&state=${c.value}`),location.href=`${s.value}?client_id=${u.value}&response_type=code&redirect_uri=${d.value}&scope=read%3Aaccount%20write%3Anotes%20read%3Areactions&code_challenge=${p}&code_challenge_method=S256&state=${c.value}`}return x(()=>{console.log(f,p),d.value=encodeURIComponent("https://quest.howeverina.studio/redirect"),u.value=encodeURIComponent("https://quest.howeverina.studio/login"),c.value=window.crypto.randomUUID(),console.log("state",c.value)}),(_,e)=>{const y=k;return q(),A(b,null,[e[4]||(e[4]=r("link",{rel:"redirect_uri",href:"/redirect"},null,-1)),r("div",E,[C(y,{to:"/",class:"u-url p-name"},{default:U(()=>[...e[2]||(e[2]=[R("DailyQuest",-1)])]),_:1})]),r("div",F,[r("div",M,[e[3]||(e[3]=r("h3",null,"서버 주소를 입력해주세요.",-1)),I(r("input",{"onUpdate:modelValue":e[0]||(e[0]=v=>V(a)?a.value=v:a=v),placeholder:"서버 주소"},null,512),[[S,m(a)]]),r("div",{class:"quest-done",onClick:e[1]||(e[1]=v=>w(m(a)))},"로그인")])])],64)}}};export{L as default};
