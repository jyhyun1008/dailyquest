import{_ as w}from"./c1INS_Z1.js";import{r as n,j as y,c as $,a as o,l as A,v as C,k as h,m as k,b as x,w as U,F as b,o as I,d as S}from"./SKZjbDAC.js";const V={id:"parent-wrapper"},q={id:"quest-wrapper"},B={class:"h-app"},v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-._~",T={__name:"login",setup(M){var a="";async function _(t){const u=new TextEncoder().encode(t),l=await window.crypto.subtle.digest("SHA-256",u),m=Array.from(new Uint8Array(l));return btoa(String.fromCharCode.apply(null,m)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const c=n(null),f=n(null),r=n(null),s=n(null),i=n(null),d=n(null);async function g(t){const e=await $fetch(`https://${t}/.well-known/oauth-authorization-server`);console.log(e),c.value=e.authorization_endpoint,f.value=e.token_endpoint,console.log(`${c.value}?client_id=${d.value}&response_type=code&redirect_uri=${i.value}&scope=read%3Aaccount%20write%3Anotes%20read%3Areactions&code_challenge=${r.value}&code_challenge_method=S256&state=${s.value}`),location.href=`${c.value}?client_id=${d.value}&response_type=code&redirect_uri=${i.value}&scope=read%3Aaccount%20write%3Anotes%20read%3Areactions&code_challenge=${r.value}&code_challenge_method=S256&state=${s.value}`}const p=new Array(128).fill(0).map(()=>v[Math.floor(v.length*Math.random())]).join("");return console.log("code_verifier",p),y(()=>{(async()=>{try{r.value=await _(p),console.log("code_challenge",r.value)}catch(t){console.error("Code challenge 생성 오류:",t)}})(),i.value=encodeURIComponent("https://quest.howeverina.studio/redirect"),d.value=encodeURIComponent("https://quest.howeverina.studio/login"),s.value=window.crypto.randomUUID(),console.log("state",s.value)}),(t,e)=>{const u=w;return I(),$(b,null,[e[4]||(e[4]=o("link",{rel:"redirect_uri",href:"/redirect"},null,-1)),o("div",V,[o("div",q,[e[2]||(e[2]=o("h3",null,"서버 주소를 입력해주세요.",-1)),A(o("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>k(a)?a.value=l:a=l),placeholder:"서버 주소"},null,512),[[C,h(a)]]),o("div",{class:"quest-done",onClick:e[1]||(e[1]=l=>g(h(a)))},"로그인")])]),o("div",B,[x(u,{to:"/",class:"u-url p-name"},{default:U(()=>[...e[3]||(e[3]=[S("DailyQuest",-1)])]),_:1})])],64)}}};export{T as default};
