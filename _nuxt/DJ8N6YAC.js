import{_ as P}from"./3bEa2rYO.js";import{r as a,g as R,j,c,a as e,d as m,b as $,w as q,t as h,k as w,v as S,l as _,m as T,F as z,n as A,p as k,o as v}from"./Cmva7bMt.js";const J={id:"parent-wrapper"},L={id:"point-wrapper"},U={class:"quest-done"},D={style:{"font-size":"4rem"}},E={id:"out-wrapper"},F={id:"out-items-wrapper"},M={class:"quest-item"},Q={id:"quest-wrapper"},G={class:"quest-button"},H={id:"quest-items-wrapper"},K={class:"quest-items"},W={key:0,class:"quest-category"},X={key:1,class:"quest-item"},Y={class:"quest-title"},Z={class:"quest-point"},tt=["onClick"],at={__name:"index",setup(et){const N=a(null),i=a(null),y=a(null),x=a(null),r=a(null),b=a(!0),I=a(null),g=R();var u="",d=0;const n=a(null),O=function(){return"/record/"},p=function(o){return{title:o.split("- ")[1]?.split(":")[0],point:parseInt(o.split(": ")[1]?.split("í¬ì¸íŠ¸")[0])}},V=async function(o){await $fetch(`https://${localStorage.getItem("host")}/api/notes/create`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${n.value}`,"Content-Type":"application/json"},body:JSON.stringify({text:`ðŸŒ¸ #dailyquest ì—ì„œ ${p(o).title} ì„(ë¥¼) ì™„ë£Œí•˜ê³  ${p(o).point} í¬ì¸íŠ¸ë¥¼ ë²Œì—ˆì–´ìš”!
ì†Œì§€ í¬ì¸íŠ¸: ðŸª™ ${r.value+p(o).point}
#${i.value}_dailyquest`,visibility:"followers"})}),k()},C=async function(o,t){await $fetch(`https://${localStorage.getItem("host")}/api/notes/create`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${n.value}`,"Content-Type":"application/json"},body:JSON.stringify({text:`ðŸª½ #dailyquest ì—ì„œ ${o} ì„(ë¥¼) ëª©ì ìœ¼ë¡œ ${t} í¬ì¸íŠ¸ë¥¼ ì†Œëª¨í–ˆì–´ìš”!
ì†Œì§€ í¬ì¸íŠ¸: ðŸª™ ${r.value-t}
#${i.value}_dailyquest`,visibility:"followers"})}),k()};return j(async()=>{if(n.value=localStorage.getItem("accessToken")?localStorage.getItem("accessToken"):g.query.at?g.query.at:"",n){const o=await $fetch(`https://${localStorage.getItem("host")}/api/i`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${n.value}`,"Content-Type":"application/json"},body:JSON.stringify({})});i.value=o.username,N.value=o;const s=(await $fetch(`https://${localStorage.getItem("host")}/api/notes/search-by-tag`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${n.value}`,"Content-Type":"application/json"},body:JSON.stringify({tag:`${i.value}_dq_list`})}))[0]?.text.split("```\n")[1]?.split("\n```")[0]?.split(`
`);y.value=s;let l=await $fetch(`https://${localStorage.getItem("host")}/api/notes/search-by-tag`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${n.value}`,"Content-Type":"application/json"},body:JSON.stringify({tag:`${i.value}_dailyquest`})});l=l.filter(B=>B.user.username==i.value),x.value=l,r.value=0,l.length!==0&&(r.value=parseInt(l[0].text.split("í¬ì¸íŠ¸: ðŸª™ ")[1].split(`
`)[0]))}else{I.value=new Error("URLì— accessTokenì´ ì—†ìŠµë‹ˆë‹¤."),b.value=!1,location.href="https://quest.howeverina.studio/login/";return}}),(o,t)=>{const f=P;return v(),c("div",J,[e("div",L,[e("div",null,[t[4]||(t[4]=m("ë‚´ê°€ ê°€ì§„ í¬ì¸íŠ¸ ",-1)),e("span",U,[$(f,{to:O()},{default:q(()=>[...t[3]||(t[3]=[m("ë‚´ì—­",-1)])]),_:1},8,["to"])])]),e("div",D,"ðŸª™ "+h(r.value),1)]),e("div",E,[e("div",F,[t[5]||(t[5]=e("div",{class:"quest-category"},[e("h3",null,"ì†Œëª¨í•˜ê¸°")],-1)),e("div",M,[w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>T(u)?u.value=s:u=s),class:"quest-title",placeholder:"í•­ëª©"},null,512),[[S,_(u)]]),w(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>T(d)?d.value=s:d=s),class:"quest-point",placeholder:"ê¸ˆì•¡"},null,512),[[S,_(d)]]),e("div",{class:"quest-done",onClick:t[2]||(t[2]=s=>C(_(u),_(d)))},"ì†Œëª¨")])])]),e("div",Q,[t[7]||(t[7]=e("h2",null,"ðŸŒ¸ ë‚´ í€˜ìŠ¤íŠ¸ ðŸŒ¸",-1)),e("span",G,[$(f,{to:"/update/"},{default:q(()=>[...t[6]||(t[6]=[m("ëª©ë¡ ìˆ˜ì •í•˜ê¸°",-1)])]),_:1})]),e("div",H,[(v(!0),c(z,null,A(y.value,s=>(v(),c("div",K,[s[0]!=="-"?(v(),c("div",W,[e("h3",null,h(s),1)])):(v(),c("div",X,[e("div",Y,h(p(s).title),1),e("div",Z,h(p(s).point),1),e("div",{class:"quest-done",onClick:l=>V(s)},"ì™„ë£Œ",8,tt)]))]))),256))])])])}}};export{at as default};
