import{_ as b}from"./CcbVVoxj.js";import{r as a,g as I,j as V,c as u,a as e,d as f,b as y,w as q,t as p,k as O,v as B,l as $,m as L,F as R,n as j,o as d}from"./CuQZR2zk.js";const C={id:"parent-wrapper"},z={id:"point-wrapper"},P={class:"quest-done"},A={style:{"font-size":"4rem"}},J={id:"quest-wrapper"},E={class:"quest-button"},D={id:"quest-items-wrapper"},F={class:"quest-items"},M={key:0,class:"quest-category"},U={key:1,class:"quest-item"},Q={class:"quest-title"},G={class:"quest-point"},X={__name:"update",setup(H){const w=a(null),n=a(null),c=a(null),S=a(null),v=a(null),T=a(!0),k=a(null),_=I();var i="";const l=a(null),x=function(){return"/record/"},g=function(o){return{title:o.split("- ")[1]?.split(":")[0],point:parseInt(o.split(": ")[1]?.split("í¬ì¸íŠ¸")[0])}},N=async function(o){await $fetch(`https://${localStorage.getItem("host")}/api/notes/create`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${l.value}`,"Content-Type":"application/json"},body:JSON.stringify({text:`${n.value}ì˜ #dailyquest ì˜ˆìš”!
#${n.value}_dq_list
\`\`\`
${o}
\`\`\``,visibility:"specified"})}),location.href="https://quest.howeverina.studio/"};return V(async()=>{if(l.value=localStorage.getItem("accessToken")?localStorage.getItem("accessToken"):_.query.at?_.query.at:"",!l){k.value=new Error("URLì— accessTokenì´ ì—†ìŠµë‹ˆë‹¤."),T.value=!1;return}const o=await $fetch(`https://${localStorage.getItem("host")}/api/i`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${l.value}`,"Content-Type":"application/json"},body:JSON.stringify({})});n.value=o.username,w.value=o;const s=(await $fetch(`https://${localStorage.getItem("host")}/api/notes/search-by-tag`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${l.value}`,"Content-Type":"application/json"},body:JSON.stringify({tag:`${n.value}_dq_list`})}))[0]?.text.split("```\n")[1]?.split("\n```")[0]?.split(`
`);c.value=s,i=s?s.join(`
`):`ì¹´í…Œê³ ë¦¬
- í•­ëª©1: 100í¬ì¸íŠ¸`,document.querySelector("#quest-list").addEventListener("input",m=>{console.log("dd"),c.value=m.target.value.split(`
`)});let r=await $fetch(`https://${localStorage.getItem("host")}/api/notes/search-by-tag`,{method:"POST",server:!1,headers:{Authorization:`Bearer ${l.value}`,"Content-Type":"application/json"},body:JSON.stringify({tag:`${n.value}_dailyquest`})});r=r.filter(m=>m.user.username==n.value),S.value=r,v.value=0,r.length!==0&&(v.value=parseInt(r[0].text.split("í¬ì¸íŠ¸: ðŸª™ ")[1].split(`
`)[0]))}),(o,t)=>{const h=b;return d(),u("div",C,[e("div",z,[e("div",null,[t[3]||(t[3]=f("ë‚´ê°€ ê°€ì§„ í¬ì¸íŠ¸ ",-1)),e("span",P,[y(h,{to:x()},{default:q(()=>[...t[2]||(t[2]=[f("ë‚´ì—­",-1)])]),_:1},8,["to"])])]),e("div",A,"ðŸª™ "+p(v.value),1)]),e("div",J,[t[6]||(t[6]=e("h2",null,"ðŸŒ¸ ë‚´ í€˜ìŠ¤íŠ¸ ðŸŒ¸",-1)),O(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=s=>L(i)?i.value=s:i=s),id:"quest-list"},null,512),[[B,$(i)]]),e("span",E,[y(h,{to:"https://quest.howeverina.studio/"},{default:q(()=>[...t[4]||(t[4]=[f("ëŒì•„ê°€ê¸°",-1)])]),_:1})]),e("span",{class:"quest-button",onClick:t[1]||(t[1]=s=>N($(i)))},"ìˆ˜ì •ì™„ë£Œ"),t[7]||(t[7]=e("h2",null,"ðŸŒ¸ ë¯¸ë¦¬ë³´ê¸° ðŸŒ¸",-1)),e("div",D,[(d(!0),u(R,null,j(c.value,s=>(d(),u("div",F,[s[0]!=="-"?(d(),u("div",M,[e("h3",null,p(s),1)])):(d(),u("div",U,[e("div",Q,p(g(s).title),1),e("div",G,p(g(s).point),1),t[5]||(t[5]=e("div",{class:"quest-done"},"ì™„ë£Œ",-1))]))]))),256))])])])}}};export{X as default};
